---
title: "hill-function-statistics"
author: "Nobuaki Masaki"
date: "5 August 2019"
output: html_document
---

```{r}
#This code is used to create plots after all of the hill-function-statistics...R files are run to generate the data needed for the plots. Note that x and y in the code refer to x_2 and x_1 respectively in the paper. (Note that none of these plots are in the paper.)

library(tidyverse)
library(data.table)
library(parallel)
```

```{r}
hill1 <- read.csv("hill-function-statistics_n_1.csv")
hill2 <- read.csv("hill-function-statistics_n_2.csv")
hill3 <- read.csv("hill-function-statistics_n_3.csv")
hill4 <- read.csv("hill-function-statistics_n_4.csv")
hill5 <- read.csv("hill-function-statistics_n_5.csv")
hill6 <- read.csv("hill-function-statistics_n_6.csv")

hill <- rbind(hill1, hill2, hill3, hill4, hill5, hill6)

hill_gamma <- hill %>% filter(gamma == 1)
hill_x <- hill %>% filter(x_bar == 50)
hill_y <- hill %>% filter(y_bar == 50)

#write.csv(hill, "hill-function-statistics.csv", row.names = FALSE)
```

```{r}
ggplot(hill, aes(true_n, true_K, fill = log(abs(derrorAB_dn)))) + geom_tile() + facet_grid(y_bar ~ x_bar + gamma)
ggplot(hill, aes(true_n, true_K, fill = log(derrorBC_dn + 0.001))) + geom_tile() + facet_grid(y_bar ~ x_bar + gamma)

ggplot(hill, aes(true_n, true_K, fill = log(abs(derrorAB_dK)))) + geom_tile() + facet_grid(y_bar ~ x_bar + gamma)
ggplot(hill, aes(true_n, true_K, fill = log(derrorBC_dK + 0.001))) + geom_tile() + facet_grid(y_bar ~ x_bar + gamma)
```

```{r}
ggplot(hill, aes(Fc, derrorAB_dn, color = true_K, size = true_n)) + geom_point() + facet_grid(y_bar ~ x_bar + gamma, scales = "free")
ggplot(hill, aes(Fc, derrorBC_dn)) + geom_point() + facet_grid(y_bar + x_bar ~ gamma, scales = "free")

ggplot(hill, aes(Fc, derrorAB_dK, color = true_K, size = true_n)) + geom_point() + facet_grid(y_bar ~ x_bar + gamma, scales = "free")
ggplot(hill, aes(Fc, derrorBC_dK)) + geom_point() + facet_grid(y_bar + x_bar ~ gamma, scales = "free")
```